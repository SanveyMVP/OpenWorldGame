<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="OpenWorldGame : Unity3D, 3D Game, Slua, 热更新，AI">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>OpenWorldGame</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/nottvlike/OpenWorldGame">View on GitHub</a>

          <h1 id="project_title">OpenWorldGame</h1>
          <h2 id="project_tagline">Unity3D, 3D Game, Slua, 热更新，AI</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/nottvlike/OpenWorldGame/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/nottvlike/OpenWorldGame/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="目录" class="anchor" href="#%E7%9B%AE%E5%BD%95" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>目录</h1>

<ul>
<li>  <a href="#1">1.前言</a>

<ul>
<li>  <a href="#1.1">1.1.Unity3d开发版本</a>
</li>
<li>  <a href="#1.2">1.2.第三方插件</a>
</li>
</ul>
</li>
<li>  <a href="#2">2.基本约定</a>

<ul>
<li>  <a href="#2.1">2.1.两中开发模式</a>
</li>
<li>  <a href="*2.2">2.2.三个路径</a>
</li>
<li>  <a href="*2.3">2.3.四类资源文件夹</a>
</li>
</ul>
</li>
<li>  <a href="#3">3.主要模块介绍</a>

<ul>
<li>  <a href="#3.1">3.1.Slua模块</a>

<ul>
<li>  <a href="#3.1.1">3.1.1 lua常用函数介绍</a>
</li>
<li>  <a href="#3.1.2">3.1.2 lua回调系统设计</a>
</li>
</ul>
</li>
<li>  <a href="#3.2">3.2.行为树模块</a>

<ul>
<li>  <a href="#3.2.1">3.2.1 Behavior3介绍</a>
</li>
<li>  <a href="#3.2.2">3.2.2 Behavior3lua</a>
</li>
</ul>
</li>
<li>  <a href="#3.3">3.3.热更新模块</a>
</li>
<li>  <a href="#3.4">3.4.资源管理模块</a><br>
</li>
</ul>
</li>
<li>  <a href="#4">4.后序计划</a>
<br>
</li>
</ul>

<h2 id="1">
<a id="1---前言" class="anchor" href="#1---%E5%89%8D%E8%A8%80" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1.   前言</h2>

<p>OpenWorldGame是希望自己在学习unity3d的过程中，慢慢实现一个相对复杂的游戏框架，目前只包含客户端部分。对于这部分，有如下几个要求：</p>

<ul>
<li>  游戏主要逻辑使用lua语言实现；</li>
<li>  支持游戏常用的功能，例如AI，热更新，资源管理;</li>
<li>  尽量少的使用第三方插件，第三方插件一方面在使用上不自由（无法做自己想做的改动），另一方面需要确定导出lua接口后能否正常工作。</li>
</ul>

<p>---- 更新于2016年1月31日:</p>

<p>加了热更新和资源管理的代码，虽然还是个大demo，不过也总算有一点样子了，热更新只在文件系统内做了一些测试，还没有涉及到网络这一块，以后会加上网络模块然后先测试下内网更新，东西还很粗糙，还有很多地方比较混乱，先慢慢补下文档。</p>

<h3 id="1.1">
<a id="11----unity3d版本" class="anchor" href="#11----unity3d%E7%89%88%E6%9C%AC" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1.1    Unity3d版本</h3>

<p>Unity3d 5.0.1</p>

<h3 id="1.2">
<a id="12----第三方插件" class="anchor" href="#12----%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8F%92%E4%BB%B6" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1.2    第三方插件</h3>

<ul>
<li>  slua : <a href="https://github.com/pangweiwei/slua">https://github.com/pangweiwei/slua</a>
</li>
</ul>

<h2 id="2">
<a id="2---基本约定" class="anchor" href="#2---%E5%9F%BA%E6%9C%AC%E7%BA%A6%E5%AE%9A" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2.   基本约定</h2>

<h3 id="2.1">
<a id="21----两种开发模式" class="anchor" href="#21----%E4%B8%A4%E7%A7%8D%E5%BC%80%E5%8F%91%E6%A8%A1%E5%BC%8F" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2.1    两种开发模式</h3>

<p>区别目前仅在资源读取和是否有log这两个方面，开关是LuaManager.DEBUG:</p>

<ul>
<li>  DEBUG:  LuaManager.DEBUG = true时开启，使用Resources.Load()加载资源，只能使用Resources目录下的资源；</li>
<li>  RELEASE:    LuaManager.DEBUG = false时开启，使用www加载资源，只能使用persistentDataPath路径下的资源。</li>
</ul>

<h3 id="2.2">
<a id="22----三种路径" class="anchor" href="#22----%E4%B8%89%E7%A7%8D%E8%B7%AF%E5%BE%84" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2.2    三种路径</h3>

<ul>
<li>  Resources路径：未做打包，加密等处理的原始资源，仅在DEBUG模式下使用；</li>
<li>  persistentDataPath路径：经过打包，加密处理后的资源，在RELEASE模式下使用，需要先下载；</li>
<li>  Update路径：热更新地址，目前暂时使用文件系统内的一个文件夹代替</li>
</ul>

<h3 id="2.3">
<a id="23-四类资源文件夹" class="anchor" href="#23-%E5%9B%9B%E7%B1%BB%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E5%A4%B9" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2.3 四类资源文件夹</h3>

<ul>
<li>  Prefab/AssetBundle：   在debug开发模式是Prefab文件夹，而在release模式下是AssetBundle文件夹</li>
<li>  Config：       保存配置文件</li>
<li>  Script：       lua脚本文件夹</li>
<li>  Update：       提供热更新功能的Lua代码</li>
</ul>

<h2 id="3">
<a id="3---主要功能模块介绍" class="anchor" href="#3---%E4%B8%BB%E8%A6%81%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97%E4%BB%8B%E7%BB%8D" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3.   主要功能模块介绍</h2>

<h3 id="3.1">
<a id="31----slua模块" class="anchor" href="#31----slua%E6%A8%A1%E5%9D%97" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3.1    Slua模块</h3>

<p>unity3d常用的lua插件有slua,ulua和nlua，选择slua的主要原因是官方宣称slua相对于其它插件速度更快（当然并非是lua语言执行的速度，而是lua调用unity3d接口执行的速度），这一点以后会做验证。</p>

<p>先来说下我这段时间使用slua的感受吧，我觉得使用slua导出c#的接口给lua是很方便的，只需要改动下Slua/Editor/CustomExport.cs文件就好了，不但支持自定义接口导出，还支持dll接口导出（这个我倒是没用过）。使用lua最麻烦的地方就在于导出其它语言的接口给lua，slua在这一点上做的非常出色。</p>

<h4 id="3.1.1">
<a id="311----lua常用函数" class="anchor" href="#311----lua%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3.1.1    lua常用函数</h4>

<p>这里介绍下使用lua时经常用到的一些方法，大部分是网上其它牛人已经实现好了的，转来转去的基本找不到原作者了，不过我会尽量标明引用的出处。</p>

<h6>
<a id="classsuper" class="anchor" href="#classsuper" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Class(super)</h6>

<p>对于lua中的class实现，有以下几个要求：</p>

<ul>
<li>  继承，能够调用父类的方法和字段（这里若想实现private,protected就有些为难了）;</li>
<li>  new时能够先调用父类的构造函数（当然不仅仅包括两层的继承关系，构造函数也仅是我们虚拟的一个ctor方法）。</li>
<li>  new时创建一个新的table</li>
</ul>

<p>出处：<a href="http://blog.codingnow.com/cloud/LuaOO/">http://blog.codingnow.com/cloud/LuaOO/</a></p>

<p>----更新于2016年1月31日：</p>

<p>Class()这个功能现在使用的是quick-cocos2d-x框架里的版本，更改的原因在于前一个Class()函数无法很好的解决继承问题，</p>

<h6>
<a id="createuuid" class="anchor" href="#createuuid" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>createUUID()</h6>

<p>出处：<a href="http://blog.163.com/chatter@126/blog/static/127665661201501313123285/">http://blog.163.com/chatter@126/blog/static/127665661201501313123285/</a></p>

<h4 id="3.1.2">
<a id="312----lua回调系统设计" class="anchor" href="#312----lua%E5%9B%9E%E8%B0%83%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3.1.2    Lua回调系统设计</h4>

<p>lua脚本无法像C#那样以组件的形式添加到GameObject上，因此Unity3d里的大部分事件无法监听到。lua回调系统便是为了为了解决这个问题而设计的，主要包含以下几个类：</p>

<ul>
<li>  LuaEventManager，用来注册各种unity3d事件，将绑定了luafunction的c#脚本以组件形式添加到gameobject身上；</li>
<li>  LuaBaseEvent，基类，所有绑定luafunction的C#脚本都需要继承这个类</li>
<li>  LuaAnimationEvent，AnimationClip可以添加一些回调函数，在播放动画时会调用相应的函数。</li>
</ul>

<h3 id="3.2">
<a id="32----行为树模块" class="anchor" href="#32----%E8%A1%8C%E4%B8%BA%E6%A0%91%E6%A8%A1%E5%9D%97" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3.2    行为树模块</h3>

<h4 id="3.2.1">
<a id="321----behavior3介绍" class="anchor" href="#321----behavior3%E4%BB%8B%E7%BB%8D" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3.2.1    Behavior3介绍</h4>

<p>Behavior3是偶然在网上找到一个行为树的代码实现，作者只实现了几个基本的composite,decorators和actions,不过提供了一个web应用来设计行为树，我试了下还是很方便的。</p>

<p>详细信息：<a href="https://github.com/behavior3/behavior3editor">https://github.com/behavior3/behavior3editor</a></p>

<h4 id="3.2.2">
<a id="322----behavior3lua" class="anchor" href="#322----behavior3lua" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3.2.2    Behavior3lua</h4>

<p>作者提供了python和js版本的实现接口，所以我实现了大部分lua版本的接口。</p>

<p>详细信息：<a href="https://github.com/nottvlike/behavior3lua">https://github.com/nottvlike/behavior3lua</a></p>

<h3 id="3.3">
<a id="33----热更新模块稍后添加" class="anchor" href="#33----%E7%83%AD%E6%9B%B4%E6%96%B0%E6%A8%A1%E5%9D%97%E7%A8%8D%E5%90%8E%E6%B7%BB%E5%8A%A0" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3.3    热更新模块（稍后添加）</h3>

<h3 id="3.4">
<a id="34-资源管理模块" class="anchor" href="#34-%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3.4 资源管理模块</h3>

<h2 id="4">
<a id="4---后序计划" class="anchor" href="#4---%E5%90%8E%E5%BA%8F%E8%AE%A1%E5%88%92" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>4.   后序计划</h2>

<ul>
<li>  补充文档，这始终是一个大头，写文档的同时也能够理清思路</li>
<li>  完善热更，资源管理功能，添加网络模块</li>
<li>  研究AI和behavior3的AI设计工具</li>
</ul>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">OpenWorldGame maintained by <a href="https://github.com/nottvlike">nottvlike</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
